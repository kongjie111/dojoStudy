<!DOCTYPE html>
<html >
<head>

	<link rel="stylesheet" href="http://localhost/arcgis_js_api/library/3.23/3.23/dijit/themes/claro/claro.css">
	<title>Portland Tile Server</title>
	<script>
	        dojoConfig = {
            //parseOnLoad: true,
			isDebug: true,
			async: true,//出现这句话后dojo.require就不能用了
            packages: [{
                name: 'js',
                location: location.pathname.replace(/\/[^/]+$/, "") + "/js"
            }]
        };
	</script>
	    <link rel="stylesheet" href="http://localhost/arcgis_js_api/library/3.23/3.23/esri/css/esri.css">
    <link rel="stylesheet" href="http://localhost/arcgis_js_api/library/3.23/3.23/dijit/themes/tundra/tundra.css">
    
    <script src="http://localhost/arcgis_js_api/library/3.23/3.23/init.js"></script>
	<script>
	//dojo.require("esri.map");
	var map;
	var BDcvalayer,BDimglayer,BDveclayer,
		GDcvalayer,GDimglayer,GDveclayer,
		TDTcvalayer,TDTimglayer,TDTveclayer,
		GGcvalayer,GGimglayer,GGveclayer;
	
	require(["esri/map",
	"dojo/query",
	"dojo/parser",
	"dijit/layout/AccordionContainer", 
	"dijit/layout/ContentPane", 
	"dijit/layout/BorderContainer",
	"dijit/layout/AccordionPane",
	"js/TDTLayer",
    "js/GaodeLayer",
	"js/BaiduLayer",
	"js/GoogleLayer",
	"dojo/domReady!"],function(Map,query,parser,AccordionContainer,ContentPane,BorderContainer,AccordionPane,TDTLayer,GaodeLayer,BaiduLayer,GoogleLayer){
		parser.parse(); //与parseOnLoad: true效果相同，两次解析界面，所以报错
	    
		BDcvalayer = new BaiduLayer({layertype: "bd_cva"});
		BDimglayer = new BaiduLayer({layertype: "bd_img"});
		BDveclayer = new BaiduLayer({layertype: "bd_vec"});
		GDcvalayer = new GaodeLayer({layertype: "gd_cva"});
		GDimglayer = new GaodeLayer({layertype: "gd_img"});
		GDveclayer = new GaodeLayer({layertype: "gd_vec"});
		TDTcvalayer= new TDTLayer({layertype:"tdt_cva"});
		TDTimglayer= new TDTLayer({layertype:"tdt_img"});
		TDTveclayer= new TDTLayer({layertype:"tdt_vec"});
		GGcvalayer = new GoogleLayer({layertype:"gg_cva"});
		GGimglayer = new GoogleLayer({layertype:"gg_img"});
		GGveclayer = new GoogleLayer({layertype:"gg_vec"});
		//map.addLayer(BDveclayer);
		good("BD");
});
	
	function Show(obj)
	{
	//先执行show函数，后执行domready，所以good函数不能放外面
	if(map==null)
	{
		map = new esri.Map("mapdiv",{logo:false});
	}
	else
	{
		map.destroy();
		map = new esri.Map("mapdiv",{logo:false,center: [116.373798,39.938617],
                    zoom: 4});
		good(obj.id);
	}
	
	}
	function good(obj)
	{
	map.addLayer(eval(obj+"veclayer"));
	map.addLayer(eval(obj+"imglayer"));
	map.addLayer(eval(obj+"cvalayer"));
	var layer;
	
	layer = map.getLayer(map.layerIds[0]);
	layer.setVisibility(dojo.byId(obj+"vec").checked);
	layer = map.getLayer(map.layerIds[1]);
	layer.setVisibility(dojo.byId(obj+"img").checked);
	layer = map.getLayer(map.layerIds[2]);
	layer.setVisibility(dojo.byId(obj+"cva").checked);
	}
	
	function changeLayer1(obj)
	{
	var layer = map.getLayer(map.layerIds[0]);
	layer.setVisibility(obj.checked);
	}
	function changeLayer2(obj)
	{
	var layer = map.getLayer(map.layerIds[1]);
	layer.setVisibility(obj.checked);
	}
	function changeLayer3(obj)
	{
	var layer = map.getLayer(map.layerIds[2]);
	layer.setVisibility(obj.checked);
	}
	</script>
	
	<style text="text/css">
	html,body,#MainborderContainer{
	width:100%;
	height:100%;
	margin:0;
	}
	#leftAccordion{
	
	}
	</style>

</head>
<body class="claro">
    <div data-dojo-type="dijit/layout/BorderContainer" data-dojo-props="gutters:true,liveSplitters:false"  
        id="MainborderContainer">
    <div data-dojo-type="dijit/layout/AccordionContainer" data-dojo-props="region:'left',splitter:true" id="leftAccordion">
        <div data-dojo-type="dijit/layout/AccordionPane" title="百度地图" id="BD" onShow="Show(this)" > 
			<p><input type="checkbox" name="checkbox" id="BDcva" onclick="changeLayer3(this)">标注</p>
			<p><input type="checkbox" name="checkbox" id="BDimg" onclick="changeLayer2(this)">卫星影像</p>
		    <p><input type="checkbox" name="checkbox" id="BDvec" onclick="changeLayer1(this)" checked="true">矢量图</p>
            </div>  
            <div data-dojo-type="dijit/layout/AccordionPane" title="高德地图"  id="GD" onShow="Show(this)">
			<p><input type="checkbox" name="checkbox" id="GDcva" onclick="changeLayer3(this)">标注</p>
            <p><input type="checkbox" name="checkbox" id="GDimg" onclick="changeLayer2(this)">卫星影像</p>
			<p><input type="checkbox" name="checkbox" id="GDvec" onclick="changeLayer1(this)" checked="true">矢量图</p>
            </div>  
            <div data-dojo-type="dijit/layout/AccordionPane" title="天地图"  id="TDT" onShow="Show(this)">
			<p><input type="checkbox" name="checkbox" id="TDTcva" onclick="changeLayer3(this)">标注</p>
            <p><input type="checkbox" name="checkbox" id="TDTimg" onclick="changeLayer2(this)">卫星影像</p>
			<p><input type="checkbox" name="checkbox" id="TDTvec" onclick="changeLayer1(this)" checked="true">矢量图</p>
            </div>  
            <div data-dojo-type="dijit/layout/AccordionPane" title="谷歌地图" id="GG" onShow="Show(this)">
			<p><input type="checkbox" name="checkbox" id="GGcva" onclick="changeLayer3(this)">标注</p>
            <p><input type="checkbox" name="checkbox" id="GGimg" onclick="changeLayer2(this)">卫星影像</p>
			<p><input type="checkbox" name="checkbox" id="GGvec" onclick="changeLayer1(this)" checked="true">矢量图</p>
            </div> 
    </div>
	<div data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'center'" id="mapdiv"> </div>
</div>
</body>
</html>